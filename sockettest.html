<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <script
      src="https://cdn.socket.io/4.5.0/socket.io.min.js"
      integrity="sha384-7EyYLQZgWBi67fBtVxw60/OWl1kjsfrPFcaU0pp0nAh+i8FD068QogUvg85Ewy1k"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <button id="message">send message</button>
    <button id="test-docket2">Zapusk soketa</button>
    <script>
      const test = async () => {
        const data = await fetch('http://localhost:3000/api/signin', {
          method: 'POST',
          credentials: 'include',
          headers: {
            'Content-Type': 'application/json',
            Accept: 'application/json',
          },
          body: JSON.stringify({
            email: 'kulagin@netology.ru',
            password: 'ad service',
          }),
        });

        const json = await data.json();

        console.log(json);

        const socket = io.connect('http://localhost:3000', {
          withCredentials: true,
        });

        socket.emit('whoami');

        socket.on('whoareyou', (msg) => console.log('whoareyou', msg));

        socket.on('message', (msg) => {
          console.log('message: ', msg);
        });

        document
          .getElementById('message')
          .addEventListener('click', (event) => {
            event.preventDefault();
          });
      };

      document.getElementById('test-docket2').addEventListener('click', test);
    </script>
  </body>
</html>
